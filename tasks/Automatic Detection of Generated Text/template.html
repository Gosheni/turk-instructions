<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script src='https://s3.amazonaws.com/mturk-public/externalHIT_v1.js' type='text/javascript'></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,700">
  <link href="https://docs.google.com/static/forms/client/css/1404371006-formview_st_ltr.css" type="text/css" rel="stylesheet">
  <style>
  #target {
    user-select: none;
  }

  foo {
      display: inline-block;
  }

  .big {
    font-size: 16pt;
  }

  body {
    max-width: 900px;
  }

  .mg {
    color: green;
  }

  .hw {
    color: blue;
  }

  .pmg {
    color: #64af64;
  }

  .phw {
    color: #7a7aff;
  }

  #myProgress {
    width: 100%;
    background-color: grey;
  }

  #myBar {
    width: 1%;
    height: 30px;
    background-color: green;
  }

  .grid-container {
    display: grid;
    grid-template-columns: 1fr 0.8fr;
    grid-template-rows: 1fr 1fr;
    grid-template-areas: "Question Instructions" "Question Form";
    grid-column-gap: 1em;
  }

  @media only screen and (max-width: 768px) {
    .grid-container {
      display: grid;
      grid-template-columns: 1fr;
      grid-template-rows: 1fr 1fr 1fr;
      grid-template-areas: "Instructions" "Question" "Form";
      grid-column-gap: 1em;
    }
  }

  .Question { grid-area: Question; }

  .Instructions { grid-area: Instructions; }

  .Form { grid-area: Form; }

</style>
</head>
<body class="ss-base-body">
  <div class="grid-container">
    <div class="Question">
      <div id="myProgress">
        <div id="myBar"></div>
      </div>
      <div class='question_0'>
          <p class="big"><b>${text1}...</b></p>
      </div>

      <div class='question_1' style="display:none;">
          <p class="big">${text1} <b>${text2}...</b></p>
      </div>

      <div class='question_2' style="display:none;">
          <p class="big">${text1} ${text2} <b>${text3}...</b></p>
      </div>

      <div class='question_3' style="display:none;">
          <p class="big">${text1} ${text2} ${text3} <b>${text4}...</b></p>
      </div>

      <div class='question_4' style="display:none;">
          <p class="big">${text1} ${text2} ${text3} ${text4} <b>${text5}...</b></p> 
      </div>

      <div class='question_5' style="display:none;">
          <p class="big">${text1} ${text2} ${text3} ${text4} <b>${text5}...</b></p> 
      </div>
    </div>
    <div class="Instructions">
      <h2>Instructions</h2>
      <p>
      In this task you will be shown some text that was extracted from a website.
      <br/><br/>
      Guess whether the text on the left was written by a human or by a computer algorithm.
      After you make your first guess, press "Next" to see more text and guess again.
      Youâ€™ll do this for 5 times.
      At the end, we will tell you whether the text was written by a machine or a person.
      </p>
      <p>Some indicators you can look for that text might be machine-generated:</p>
      <ul>
        <li>Contradicts itself</li>
        <li>Incoherent</li>
        <li>Repetative</li>
      </ul>
      <p>Note that both human- and machine- written text might contain unusual formatting such as text in all capitals, no line-break between a title and article contents, and misaligned quotation symbols. DO NOT base your decision on formatting weirdnesses.</p>
      <br/>
    </div>
    <div class="Form">
      <form id='mturk_form' method='post' id='mturk_form' action='https://www.mturk.com/mturk/externalSubmit'>
      <!-- <form id="main-form" method="post" action="https://www.google.com/evaluation/endor/submit"> -->
        <fieldset>
        <input type="hidden" name="taskId" value="${taskId}" />
        <input type="hidden" name="assignmentId" id="assignmentId" value=""/>
        <input type="hidden" id="target_0_time_elapsed" name="target_0_time_elapsed"/>
        <input type="hidden" id="target_1_time_elapsed" name="target_1_time_elapsed"/>
        <input type="hidden" id="target_2_time_elapsed" name="target_2_time_elapsed"/>
        <input type="hidden" id="target_3_time_elapsed" name="target_3_time_elapsed"/>
        <input type="hidden" id="target_4_time_elapsed" name="target_4_time_elapsed"/>

        <div class='question_0'>
          <p>(1) What do you think the source is?</p>
          <div>
            <input type="radio" id="t0_h" name="target_0" value="h" required="" onchange='enableNext()'>
            <label class="big hw" for="t0_h">Definitely Human-written</label>
          </div>
          <div>
            <input type="radio" id="t0_maybe_h" name="target_0" value="maybe_h" required="" onchange='enableNext()'>
            <label class="big phw" for="t0_maybe_h">Possibly Human-written</label>
          </div>
          <div>
            <input type="radio" id="t0_maybe_m" name="target_0" value="maybe_m" required="" onchange='enableNext()'>
            <label class="big pmg" for="t0_maybe_m">Possibly Machine-generated</label>
          </div>
          <div>
            <input type="radio" id="t0_m" name="target_0" value="m" required="" onchange='enableNext()'>
            <label class="big mg" for="t0_m">Definitely Machine-generated</label>
          </div>
        </div>

        <div class='question_1'>
          <p>(2) What do you think the source is?</p>
          <div>
            <input type="radio" id="t1_h" name="target_1" value="h" required="" onchange='enableNext()'>
            <label class="big hw" for="t1_h">Definitely Human-written</label>
          </div>
          <div>
            <input type="radio" id="t1_maybe_h" name="target_1" value="maybe_h" required="" onchange='enableNext()'>
            <label class="big phw" for="t1_maybe_h">Possibly Human-written</label>
          </div>
          <div>
            <input type="radio" id="t1_maybe_m" name="target_1" value="maybe_m" required="" onchange='enableNext()'>
            <label class="big pmg" for="t1_maybe_m">Possibly Machine-generated</label>
          </div>
          <div>
            <input type="radio" id="t1_m" name="target_1" value="m" required="" onchange='enableNext()'>
            <label class="big mg" for="t1_m">Definitely Machine-generated</label>
          </div>
        </div>

        <div class='question_2'>
          <p>(3) What do you think the source is?</p>
          <div>
            <input type="radio" id="t2_h" name="target_2" value="h" required="" onchange='enableNext()'>
            <label class="big hw" for="t2_h">Definitely Human-written</label>
          </div>
          <div>
            <input type="radio" id="t2_maybe_h" name="target_2" value="maybe_h" required="" onchange='enableNext()'>
            <label class="big phw" for="t2_maybe_h">Possibly Human-written</label>
          </div>
          <div>
            <input type="radio" id="t2_maybe_m" name="target_2" value="maybe_m" required="" onchange='enableNext()'>
            <label class="big pmg" for="t2_maybe_m">Possibly Machine-generated</label>
          </div>
          <div>
            <input type="radio" id="t2_m" name="target_2" value="m" required="" onchange='enableNext()'>
            <label class="big mg" for="t2_m">Definitely Machine-generated</label>
          </div>
        </div>

        <div class='question_3'>
          <p>(4) What do you think the source is?</p>
          <div>
            <input type="radio" id="t3_h" name="target_3" value="h" required="" onchange='enableNext()'>
            <label class="big hw" for="t3_h">Definitely Human-written</label>
          </div>
          <div>
            <input type="radio" id="t3_maybe_h" name="target_3" value="maybe_h" required="" onchange='enableNext()'>
            <label class="big phw" for="t3_maybe_h">Possibly Human-written</label>
          </div>
          <div>
            <input type="radio" id="t3_maybe_m" name="target_3" value="maybe_m" required="" onchange='enableNext()'>
            <label class="big pmg" for="t3_maybe_m">Possibly Machine-generated</label>
          </div>
          <div>
            <input type="radio" id="t3_m" name="target_3" value="m" required="" onchange='enableNext()'>
            <label class="big mg" for="t3_m">Definitely Machine-generated</label>
          </div>
        </div>

        <div class='question_4'>
          <p>(5) What do you think the source is?</p>
          <div>
            <input type="radio" id="t4_h" name="target_4" value="h" required="" onchange='enableNext()'>
            <label class="big hw" for="t4_h">Definitely Human-written</label>
          </div>
          <div>
            <input type="radio" id="t4_maybe_h" name="target_4" value="maybe_h" required="" onchange='enableNext()'>
            <label class="big phw" for="t4_maybe_h">Possibly Human-written</label>
          </div>
          <div>
            <input type="radio" id="t4_maybe_m" name="target_4" value="maybe_m" required="" onchange='enableNext()'>
            <label class="big pmg" for="t4_maybe_m">Possibly Machine-generated</label>
          </div>
          <div>
            <input type="radio" id="t4_m" name="target_4" value="m" required="" onchange='enableNext()'>
            <label class="big mg" for="t4_m">Definitely Machine-generated</label>
          </div>
        </div>

        <div class='questionFinal'>
          <p class="big">This excerpt was actually ${truthText}!</p>
          <p>Is this surprising?</p>
          <div>
            <input type="radio" id="surprising_yes" name="surprising" value="y" required="" onchange='enableNext()'>
            <label class="big" for="surprising_yes">Yes</label>
          </div>
          <div>
            <input type="radio" id="surprising_no" name="surprising" value="n" required="" onchange='enableNext()'>
            <label class="big" for="surprising_no">No</label>
          </div>
        </div>
        <br/>
        <button id="nextButton" type="button" onclick="nextButtonFn()"><h2>Next</h2></button>
        <button id="submitButton" type="submit"><h2>Submit</h2></button>
      </fieldset>
      </form>
    </div>
  </div>
  <script>
    turkSetAssignmentID()

    var num_answered = 0;

    var time_started_question = performance.now();

    function set_visible(objects, visible) {
      for (var i=0; i<objects.length; i++) {
        if (visible) {
          objects[i].style.display = "block";
        } else {
          objects[i].style.display = "none";
        } 
      }
    }

    function setProgressBar(value, maxValue) {
      var elem = document.getElementById("myBar");
      width = (value / maxValue) * 100
      elem.style.width = width + '%';
    }

    function nextButtonFn() {
      num_answered = $('input:radio:checked').length;
      console.log('Num answered is now ' + num_answered);

      var time_elapsed = (performance.now() - time_started_question) / 1000;
      console.log('Took ' + time_elapsed);
      document.getElementById("target_" + (num_answered-1) + "_time_elapsed").value = time_elapsed;

      setProgressBar(num_answered, 5)
      set_visible(document.getElementsByClassName("question_" + (num_answered-1)), false);
      set_visible(document.getElementsByClassName("question_" + num_answered), true);

      if (num_answered < 5) {
        document.getElementById("nextButton").disabled = true;
        document.getElementById("submitButton").disabled = true;
      } else {
        set_visible([document.getElementById("nextButton")], false);
        set_visible(document.getElementsByClassName("questionFinal"), true);
        set_visible([document.getElementById("submitButton")], true);
      }

      time_started_question = performance.now();
    }

    for (var i=1; i<6; i++) {
      set_visible(document.getElementsByClassName("question_" + i), false);
    }

    function enableNext() {
      num_answered = $('input:radio:checked').length
      console.log('Num checked: ' + num_answered)
      document.getElementById("nextButton").disabled = false;
      document.getElementById("submitButton").disabled = false;
    }

    document.getElementById("nextButton").disabled = true;

    set_visible([document.getElementById("submitButton")], false);
    set_visible(document.getElementsByClassName("questionFinal"), false);
    setProgressBar(0, 5)
</script>
</body>
</html>
